<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bloom · i was here</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #050508;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
        }

        .ui {
            position: fixed;
            font-size: 0.7rem;
            color: #4a5a4a;
            z-index: 100;
        }

        .title {
            top: 30px;
            left: 30px;
        }

        .title h1 {
            font-size: 1rem;
            font-weight: normal;
            color: #6a8a6a;
        }

        .back {
            top: 30px;
            right: 30px;
        }

        .back a {
            color: #4a5a4a;
            text-decoration: none;
        }

        .back a:hover {
            color: #6a8a6a;
        }

        .instruction {
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-family: Georgia, serif;
            font-style: italic;
            color: #3a4a3a;
        }

        .bloom-count {
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="ui title">
        <h1>bloom</h1>
        <div>growth from nothing</div>
    </div>
    <div class="ui back"><a href="../index.html">← return</a></div>
    <div class="ui instruction">click to plant</div>
    <div class="ui bloom-count"><span id="count">0</span> blooms</div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const countEl = document.getElementById('count');

        let width, height;
        let blooms = [];
        let time = 0;

        class Petal {
            constructor(x, y, angle, size, hue) {
                this.x = x;
                this.y = y;
                this.angle = angle;
                this.size = size;
                this.hue = hue;
                this.growth = 0;
            }

            draw() {
                if (this.growth < 0.01) return;

                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);

                const actualSize = this.size * this.growth;

                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.bezierCurveTo(
                    actualSize * 0.3, -actualSize * 0.2,
                    actualSize * 0.6, -actualSize * 0.3,
                    actualSize, 0
                );
                ctx.bezierCurveTo(
                    actualSize * 0.6, actualSize * 0.3,
                    actualSize * 0.3, actualSize * 0.2,
                    0, 0
                );

                ctx.fillStyle = `hsla(${this.hue}, 40%, 50%, ${0.3 + this.growth * 0.3})`;
                ctx.fill();

                ctx.restore();
            }
        }

        class Bloom {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.petals = [];
                this.growth = 0;
                this.hue = 100 + Math.random() * 60;
                this.petalCount = 5 + Math.floor(Math.random() * 4);
                this.size = 30 + Math.random() * 40;
                this.layers = 2 + Math.floor(Math.random() * 2);

                // Create petals in layers
                for (let layer = 0; layer < this.layers; layer++) {
                    const layerHue = this.hue + layer * 15;
                    const layerSize = this.size * (1 - layer * 0.3);

                    for (let i = 0; i < this.petalCount; i++) {
                        const angle = (i / this.petalCount) * Math.PI * 2 + layer * 0.3;
                        this.petals.push(new Petal(x, y, angle, layerSize, layerHue));
                    }
                }
            }

            update() {
                if (this.growth < 1) {
                    this.growth += 0.01;

                    // Grow petals sequentially
                    this.petals.forEach((petal, i) => {
                        const delay = i * 0.03;
                        if (this.growth > delay) {
                            petal.growth = Math.min(1, (this.growth - delay) * 2);
                        }
                    });
                }
            }

            draw() {
                // Draw center
                const centerSize = 10 * this.growth;
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, centerSize * 2
                );
                gradient.addColorStop(0, `hsla(${this.hue + 30}, 50%, 60%, ${this.growth * 0.5})`);
                gradient.addColorStop(1, 'transparent');

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, centerSize * 2, 0, Math.PI * 2);
                ctx.fill();

                // Draw petals
                this.petals.forEach(petal => petal.draw());

                // Draw center dot
                ctx.fillStyle = `hsla(${this.hue + 30}, 60%, 70%, ${this.growth})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, centerSize * 0.5, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        function draw() {
            time += 0.016;

            // Subtle fade
            ctx.fillStyle = 'rgba(5, 5, 8, 0.02)';
            ctx.fillRect(0, 0, width, height);

            // Update and draw blooms
            blooms.forEach(bloom => {
                bloom.update();
                bloom.draw();
            });

            requestAnimationFrame(draw);
        }

        canvas.addEventListener('click', (e) => {
            blooms.push(new Bloom(e.clientX, e.clientY));
            countEl.textContent = blooms.length;
        });

        // Double click for cluster
        canvas.addEventListener('dblclick', (e) => {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const offset = 50;
                    blooms.push(new Bloom(
                        e.clientX + (Math.random() - 0.5) * offset * 2,
                        e.clientY + (Math.random() - 0.5) * offset * 2
                    ));
                    countEl.textContent = blooms.length;
                }, i * 100);
            }
        });

        resize();
        window.addEventListener('resize', resize);
        draw();
    </script>
</body>
</html>
